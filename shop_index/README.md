# Laravel入門

- [Laravel入門](#laravel入門)
  - [はじめに](#はじめに)
  - [事前準備](#事前準備)
  - [ルーティングについて](#ルーティングについて)
  - [Bladeテンプレートについて](#bladeテンプレートについて)
  - [ジャンル選択画面の作成](#ジャンル選択画面の作成)

## はじめに

LaravelはPHPで書かれたフレームワークで、モダンなウェブアプリケーションを効率的に開発するための強力なツールです。
この教材では、Laravelの基本的な機能であるルーティング、ビュー(Bladeテンプレート)について学びます。
これらの基礎を理解することで、Laravelを使用したWebアプリケーション開発の第一歩を踏み出すことができます。

---

## 事前準備

[こちらのページ]()から、ソースコードを`C:¥sys_dev_exe`へcloneしてください。

## ルーティングについて

Laravelにおけるルーティングは、URLとアプリケーション内の特定のロジックをマッピングします。
ここでいうマッピングとは、特定のURLにアクセスしたときにどのコントローラやビューを呼び出すかを定義することです。

ルーティングを定義するメリットは、アプリケーションのURL構造を簡潔に保ち、**コードの可読性を向上させることができる**点です。

では、Laravelのルーティングを定義する方法を見ていきましょう。
routes/web.php ファイルには、ウェブリクエストを処理するためのすべてのルートが含まれています。
それでは、routes/web.php ファイルを以下のように書き換えましょう。

**routes/web.php**

```php

// デフォルトのルート設定はコメントアウトしてください
// Route::get('/', function () {
//     return view('welcome');
// });

Route::get('/', function () {
    return view('index');
})->name('index');
```

`Route`クラスは、Laravelのルーティングを定義するためのクラスです。
`Route::get`メソッドは、GETリクエストを処理するためのルートを定義します。

`Route::get`メソッドの第1引数は、URLを指定します。
上記の例では、`/` となっています。

第2引数は、クロージャです。
クロージャは、指定されたURLにアクセスされたときに実行される処理を定義します。
Laravelでは、クロージャを使って、ルートに直接ロジックを記述することができます。
上記の例では、`return view('index');` は、`index.blade.php`ビューを返す処理を定義しています。

また、`->name('index')` は、このルートに名前を付けるためのメソッドです。
名前を付けることで、ビューなどからルートを参照する際に、URLを直接記述するのではなく、名前を使って参照することができます。

## Bladeテンプレートについて

Bladeテンプレートは、Laravelのテンプレートエンジンで、よりクリーンで保守しやすいHTMLを書くことができます。
ここでいうテンプレートエンジンとは、HTMLテンプレート内に変数や制御構造を埋め込むための仕組み(`{{  }}`やディレクティブ(`@`))のことです。

通常のHTMLファイルでは動作しないため、必ず「.blade.php」という拡張子をつけることを忘れないようにしましょう。

## ジャンル選択画面の作成

まずは、ジャンル選択画面(index.blade.php)の内容を確認してみましょう。
このファイルは、簡単なHTMLテンプレートで、ユーザーがジャンルを選択するフォームを提供しています。

**resources/views/index.blade.php**

```php
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ショッピングサイト</title>
</head>
<body>
<h3>ジャンル選択</h3>
<form method="POST" action="{{ route('item.index') }}">
    @csrf
    <label><input type="radio" name="genre" value="pc">パソコン</label>&nbsp;&nbsp;
    <label><input type="radio" name="genre" value="book" checked>ブック</label>&nbsp;&nbsp;
    <label><input type="radio" name="genre" value="music">ミュージック</label>&nbsp;&nbsp;
    <input type="submit" value="選択">
</form>
</body>
</html>
```



このテンプレートは、基本的なHTML構造を持っています。<html>タグで始まり、<head>と<body>に分かれています。
<head>内には、文字エンコーディングやビューポートの設定があり、タイトルとして「ショッピングサイト」が設定されています。
<body>内には、ジャンル選択のためのラジオボタンを含むフォームが含まれています。
Blade構文:

{{ route('item.index') }}: これはBladeテンプレート構文で、item.indexという名前のルートにフォームを送信するためのURLを生成します。
@csrf: このディレクティブは、Laravelが自動的にCSRFトークンを生成し、フォーム送信時のセキュリティを強化します。
フォームの構造:

フォームには、ジャンルを選択するためのラジオボタンが3つ用意されています。それぞれ「パソコン」、「ブック」、「ミュージック」の選択肢があります。
フォームが送信されると、POSTメソッドで選択されたジャンルがitem.indexルートに送信されます。

1. ビューの説明
ビューとは: ビューは、ユーザーに表示されるウェブページのことを指します。Laravelでは、ビューは通常HTMLファイルですが、Bladeテンプレートエンジンを使用することで、より動的で再利用可能なコンテンツを作成することができます。
ビューの配置場所:
resources/viewsディレクトリ内に配置されます。例えば、index.blade.phpはこのディレクトリに置かれています。
ビューの呼び出し:
ルートやコントローラからビューを呼び出すには、view()関数を使います。例えば、view('index')はresources/views/index.blade.phpファイルを参照します。
1. resourcesディレクトリとroutesディレクトリの説明
resourcesディレクトリ:
このディレクトリには、ブラウザで表示されるページをレンダリングするためのビュー(HTMLテンプレート)が含まれています。
viewsサブディレクトリには、index.blade.phpのようなBladeテンプレートが格納されています。
routesディレクトリ:
routesディレクトリには、すべてのルート定義ファイル(web.php、api.phpなど)が含まれています。
web.phpは、ウェブブラウザを通じてアクセスされるルート専用です。

1. index.blade.phpをブラウザで確認する方法
サーバーの起動:
Laravel開発サーバーを起動するには、ターミナルで次のコマンドを実行します。
bash
コードをコピーする
php artisan serve
デフォルトでは、http://localhost:8000でサーバーが起動します。
ブラウザで確認:
ブラウザを開き、http://localhost:8000にアクセスすると、index.blade.phpの内容が表示されます。
1. 補足事項
ルート名の利用:
name()メソッドを使ってルートに名前を付けることで、ルートのURLを変更する際にコード全体を修正する必要がなくなります。
例えば、route('item.index')のようにルート名を使ってURLを生成できます。
CSRFトークン:
フォーム送信時に@csrfディレクティブを使用することで、Laravelは自動的にCSRFトークンを生成し、フォームが外部からの不正なリクエストによって利用されないように保護します。
まとめ
今回学んだ内容は、index.blade.phpファイルを通じて、Laravelの基本的な機能であるルーティング、ビューの管理、そしてBladeテンプレートの使い方についてでした。これらの基礎を理解することで、Laravelを使ったウェブアプリケーション開発の初歩的な部分を確実にマスターすることができました。