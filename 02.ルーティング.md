# ルーティング

- [ルーティング](#ルーティング)
  - [ルーティングとは](#ルーティングとは)
  - [ルーティングの設定](#ルーティングの設定)
  - [まとめ](#まとめ)

## ルーティングとは

ルーティングとは、リクエストされたURLに対して、どのコントローラのどのメソッドを実行するかを指定する仕組みです。Laravelでは、 routes/web.php ファイルにルーティングの設定を記述します。

## ルーティングの設定

早速 routes ディレクトリの中身を見てみましょう。おさらいですが、routes ディレクトリは、Laravelプロジェクト内の重要なディレクトリの一つであり、アプリケーションのルーティングを定義する場所です。routes ディレクトリ配下のファイル構造は以下のようになっています。

```text
プロジェクトディレクトリ
│
-[略]-
├── routes
│   │
│   -[略]-
│   └── web.php
-[略]-
```

|ファイル名|説明|
|----|----|
|web.php| Webアプリケーションのルーティングを定義するファイルです。このファイルには、HTTPリクエスト（GET、POSTなど）とURLパスの対応を定義します。|

まずは、ルーティングの設定を記述する web.php ファイルを見てみましょう。

```php
<?php

use Illuminate\Support\Facades\Route;

/*
※実際は、ここに英語の説明文がありますが省略します。
*/

Route::get('/', function () {
    return view('welcome');
});

```

このコードは以下のように機能します：

1. HTTPリクエストメソッドの指定</br>
「Route::get(...)」は、HTTPのGETリクエストに対するルーティングを定義しています。GETリクエストは、主にウェブページを表示するために使われます。

1. URLパターンの指定</br>
 「('/', ...)」の部分で、このルーティングが適用されるURLパターンを指定しています。「'/'」 はドメイン名の直後にくるルートURL（例：http://127.0.0.1:8000/ ）を意味します。

1. ルートに紐づく処理の定義</br>
「function () { ... }」はクロージャと呼ばれる無名関数です。この関数内で、URLにアクセスされた際に実行される処理を定義します。

1. ビューの返却</br>
「return view('welcome');」の部分で、welcomeビュー<sup>[1](#note1)</sup>を返しています。</br>
この場合、resources/views ディレクトリ内にある welcome.blade.php ファイルがレンダリング<sup>[2](#note2)</sup>され、最終的にユーザーのブラウザに表示されます。</br>
<small id="note1">※1 ビューとはユーザーに表示されるHTMLページを生成するためのテンプレートのことです。詳細は別の章にて。</small></br>
<small id="note2">※2 レンダリングとは、コンピュータがプログラムの指示に従い、画像やテキストなどのデータを画面に表示することを指します。</small>

では、コードの中身がわかったところで、全体の流れを把握しましょう。なお、今回はルーティングのみの説明ですが、実際のアプリケーションでは、ルーティングの後にコントローラの処理が続くことが一般的です。

1. リクエスト</br>
   ユーザーがブラウザから http://127.0.0.1:8000/ にアクセスします。
1. マッチング</br>
   Laravelは routes/web.php 内のルーティング定義をチェックし、URLパターン「'/'」にマッチするルートを探します。
1. 処理の実行</br>
   マッチしたルートのクロージャが実行されます。この例では、welcomeビューが返されます。
1. レスポンスの返却</br>
   welcomeビューがレンダリングされ、そのHTMLがユーザーのブラウザに表示されます。</br>
   ![](./images/02/welcome_disp.png)

## まとめ

本章では、Laravelのルーティングがどのように動作するかをデフォルトのroutes/web.php 内のルーティング定義を使って説明しました。
Laravelでは、このようなシンプルなルート定義から、より複高度なルーティングまで、幅広いルーティング設定が可能ですが、まずはこの基本的なルーティングの仕組みを理解しておきましょう。
